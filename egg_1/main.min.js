const CALENDAR_CONFIG={name:"egg_1",year:"2025",months:[1],imageExt:".jpg",hasCover:!1},IMAGE_DIMENSIONS={width:750,height:1182,monthWidth:137,monthHeight:272,weekWidth:334,weekHeight:120,dayWidth:545,dayHeight:468,yearWidth:334,yearHeight:120};let aspectRatio,viewportWidth,viewportHeight,windowWidth=$(document).width();const SWIPE_TYPES={PAGED:0,SWIPER:1};let swipeType=SWIPE_TYPES.PAGED,initialSlide=1,totalDays,dayArray=[],dayFilenameArray=[];const autoTextArrays={month:{blobUrls:[],widths:[],heights:[]},week:{blobUrls:[],widths:[],heights:[]},day:{blobUrls:[],widths:[],heights:[]},year:{blobUrls:[],widths:[],heights:[]}};let swipe,mySwiper,viewHammer,datepickerNav;function toggleFullScreen(){document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen()}"desktop"==checkDevice()?windowWidth=$(".container_view").width():($(document).on("contextmenu",(function(e){e.preventDefault()})),checkInstalledApp()||$(document).on("dblclick",(function(e){toggleFullScreen()})));var resizeViewport=function(width,height){window.outerWidth?window.resizeTo(width+(window.outerWidth-window.innerWidth),height+(window.outerHeight-window.innerHeight)):(window.resizeTo(500,500),window.resizeTo(width+(500-document.body.offsetWidth),height+(500-document.body.offsetHeight)))};function loadDateImages(){CALENDAR_CONFIG.hasCover&&(dayArray.push("cover"),dayFilenameArray.push("cover"+CALENDAR_CONFIG.imageExt));for(var i=1;i<=12;i++)for(var daysInMonth=new Date(CALENDAR_CONFIG.year,CALENDAR_CONFIG.months[i-1],0).getDate(),j=1;j<=daysInMonth;j++){var dateName=("0"+i).slice(-2)+"-"+("0"+j).slice(-2);dayArray.push(CALENDAR_CONFIG.year+"-"+dateName),dayFilenameArray.push(CALENDAR_CONFIG.year+"-"+dateName+CALENDAR_CONFIG.imageExt)}totalDays=dayArray.length,getAutoTextImageArray();var stayDate=getCookie(CALENDAR_CONFIG.name+"_stay_date");stayDate&&(initialSlide=dateToArrayIndex(stayDate)),aspectRatio=windowWidth/IMAGE_DIMENSIONS.width,viewportWidth=windowWidth,viewportHeight=IMAGE_DIMENSIONS.height*aspectRatio,"desktop"==checkDevice()&&resizeViewport(viewportWidth,viewportHeight),$(".swiper-slide-p > img").width(viewportWidth).height(viewportHeight),$(".swiper-slide > img").width(viewportWidth).height(viewportHeight),setSwipeType(),loadPage(),hideSpinner()}function setSwipeType(){viewHammer||(viewHammer=new Hammer($(".container_view")[0]),viewHammer.get("swipe").set({direction:Hammer.DIRECTION_ALL}),viewHammer.on("swiperight",(function(e){e.pointers[0].pageX-e.deltaX<80&&showNavigation()}))),"desktop"==checkDevice()&&$(".container_screen").on("mouseenter",(function(e){showNavigation()})),swipeType==SWIPE_TYPES.PAGED?($(document).queue("slide_queue"),swipe||(swipe=new Hammer($(".p-container")[0]),swipe.get("swipe").set({direction:Hammer.DIRECTION_ALL}),swipe.on("swipedown",(function(e){e.pointers[0].pageY-e.deltaY<160&&queuePreviousSlide()})),"desktop"==checkDevice()?($(".container_view").off("mousedown"),$(".container_view").on("mousedown",(function(event){queueNextSlide(event)}))):swipe.on("press",(function(ev){queueNextSlide(ev)}))),$(".container_view").height($(".swiper-slide-p > img").height())):swipeType==SWIPE_TYPES.SWIPER&&($(".container_view").height($(".swiper-slide-p > img").height()),$(".swiper-container").height($(".swiper-slide > img").height()),mySwiper||($(".swiper-slide").remove(),mySwiper=new Swiper(".swiper-container",{on:{slideChange:function(){var no=parseInt($(mySwiper.slides[this.activeIndex]).children("img")[0].getAttribute("data-no"));setCookie(CALENDAR_CONFIG.name+"_stay_date",arrayIndexToDate(no),73e4),$("#datepicker_nav").val(arrayIndexToDate(no))}},direction:"vertical",grabCursor:!0})))}function queueNextSlide(ev){changeSlideQueue(nextSlide(ev))}function queuePreviousSlide(){changeSlideQueue(previousSlide())}function changeSlideQueue(fn){0==$(document).queue("slide_queue").length?($(document).queue("slide_queue",fn),$(document).dequeue("slide_queue")):$(document).dequeue("slide_queue")}function nextSlide(ev){if($(".slide-p-next").length){var floatDiv=$(".slide-p-active").clone().addClass("slide-p-float").removeClass("slide-p-active").removeClass("swiper-slide-p"),preActive=$(".slide-p-active");preActive.removeClass("slide-p-active"),$(".slide-p-next").eq(-1).addClass("slide-p-active").removeClass("slide-p-next"),setTimeout((function(){preActive.addClass("slide-p-pre").hide()}),0);var dateNo=parseInt($(".slide-p-active")[0].getAttribute("data-no"));setCookie(CALENDAR_CONFIG.name+"_stay_date",arrayIndexToDate(dateNo),73e4),$("#datepicker_nav").val(arrayIndexToDate(dateNo)),slideFloat(ev,floatDiv)}}function previousSlide(){if($(".slide-p-pre").length){$(".slide-p-pre").eq(0).show("slide",{direction:"up"},1e3),$(".slide-p-active").addClass("slide-p-next").removeClass("slide-p-active"),$(".slide-p-pre").eq(0).addClass("slide-p-active").removeClass("slide-p-pre");var dateNo=parseInt($(".slide-p-active")[0].getAttribute("data-no"));setCookie(CALENDAR_CONFIG.name+"_stay_date",arrayIndexToDate(dateNo),73e4),$("#datepicker_nav").val(arrayIndexToDate(dateNo))}}function slideFloat(ev,floatDiv){var offset;floatDiv.addClass("zborder"),$(".container_view").append(floatDiv),$(".slide-p-float").width($(".slide-p-active").width()),$(".slide-p-float").height($(".slide-p-active").height()),$(".slide-p-float > img").width($(".slide-p-active").width()),$(".slide-p-float > img").height($(".slide-p-active").height()),$(".slide-p-float")[0].style.left="10px",$(".slide-p-float")[0].style.top="10px","desktop"==checkDevice()?(offset=[$(".slide-p-float")[0].offsetLeft-ev.clientX,$(".slide-p-float")[0].offsetTop-ev.clientY],$(".container_view").mousemove((function(ev){var floatDivEl=$(".slide-p-float")[0],touch=ev;floatDivEl&&(floatDivEl.style.left=touch.clientX+offset[0]+"px",floatDivEl.style.top=touch.clientY+offset[1]+"px")})).mouseup((function(){$(this).unbind("mousemove"),$(".slide-p-float").fadeOut(400,(function(){$(".slide-p-float").remove()}))})).mouseleave((function(){$(this).unbind("mousemove"),$(".slide-p-float").fadeOut(400,(function(){$(".slide-p-float").remove()}))})),$(".slide-p-active > img")[0].ondragstart=function(){return!1},$(".slide-p-float > img")[0].ondragstart=function(){return!1}):(offset=[$(".slide-p-float")[0].offsetLeft-ev.pointers[0].clientX,$(".slide-p-float")[0].offsetTop-ev.pointers[0].clientY],$(".container_screen").on("touchmove",(function(ev){var event=ev.originalEvent;if(1==event.targetTouches.length){var floatDivEl=$(".slide-p-float")[0],touch=event.targetTouches[0];floatDivEl&&(floatDivEl.style.left=touch.clientX+offset[0]+"px",floatDivEl.style.top=touch.clientY+offset[1]+"px")}})),$(".container_screen").on("touchend",(function(ev){$(".slide-p-float").fadeOut(400,(function(){$(".slide-p-float").remove()}))})))}function showPreviousSlide(){$(".slide-p-pre").eq(0).show("slide",{direction:"up"},1e3)}function loadPage(){if($("#datepicker_nav").off("change"),!datepickerNav){datepickerNav=$("#datepicker_nav").datepicker({dateFormat:"yy-mm-dd",beforeShowDay:function(date){var string=jQuery.datepicker.formatDate("yy-mm-dd",date);return[-1!=dayArray.indexOf(string)]}});var dateString=getCookie(CALENDAR_CONFIG.name+"_stay_date");dateString||(dateString=dayArray[0]),$("#datepicker_nav").datepicker("setDate",dateString)}if($("#datepicker_nav").on("change",(function(e){var date=$("#datepicker_nav").val();setCookie(CALENDAR_CONFIG.name+"_stay_date",date,73e4),initialSlide=dateToArrayIndex(date),swipeType==SWIPE_TYPES.PAGED?moveSwipeType0():swipeType==SWIPE_TYPES.SWIPER&&mySwiper.slideTo(initialSlide-1,0,!1)})),"desktop"==checkDevice()&&($(".container_nav").off("mousedown"),$(".container_nav").on("mousedown",(function(e){e.stopPropagation()}))),$("#nav_back_icon").off("mousedown"),$("#nav_back_icon").on("mousedown",(function(e){e.stopPropagation(),hideNavigation()})),swipeType==SWIPE_TYPES.PAGED)$(".p-container").show(),$(".swiper-container").hide(),loadSwipeType0(),$(".container_screen").off("mouseup"),$(".container_screen").on("mouseup",(function(event){$(".container_screen").off("touchend"),$(".container_screen").off("touchmove")}));else if(swipeType==SWIPE_TYPES.SWIPER){$(".p-container").hide(),$(".swiper-container").show();for(var i=1;i<=totalDays;i++){var tag="";dayArray[i-1].match(/^[-\d]+$/)&&(tag=setAutoText(dayArray[i-1])),$(".swiper-wrapper").append("<div class='swiper-slide'>"+tag+"<img data-no='"+i+"' src='images/"+dayFilenameArray[i-1]+"' onerror='this.style.display=\"none\"' /></div>")}mySwiper.update(),mySwiper.slideTo(initialSlide-1,0,!1)}}function loadSwipeType0(){$(".swiper-slide-p").remove();for(var i=1;i<=totalDays;i++){var tag="";dayArray[i-1].match(/^[-\d]+$/)&&(tag=setAutoText(dayArray[i-1])),i==initialSlide?$(".p-container").prepend('<div class="swiper-slide-p slide-p-active" data-no="'+i+'">'+tag+'<img src="images/'+dayFilenameArray[i-1]+'" onerror="this.onerror=null; this.src=\'images/none.png\';" /></div>'):i>initialSlide?$(".p-container").prepend('<div class="swiper-slide-p slide-p-next" data-no="'+i+'">'+tag+'<img src="images/'+dayFilenameArray[i-1]+'"  onerror="this.onerror=null; this.src=\'images/none.png\';" /></div>'):i<initialSlide&&$(".p-container").prepend('<div class="swiper-slide-p slide-p-pre" data-no="'+i+'">'+tag+'<img src="images/'+dayFilenameArray[i-1]+'"  onerror="this.onerror=null; this.src=\'images/none.png\';" /></div>')}"desktop"==checkDevice()&&$(".slide-p-active > img")[0]&&($(".slide-p-active > img")[0].ondragstart=function(){return!1})}function moveSwipeType0(){for(var i=1;i<=totalDays;i++)i==initialSlide?$(".swiper-slide-p").eq(0-i).addClass("slide-p-active").removeClass("slide-p-next").removeClass("slide-p-pre").show():i>initialSlide?$(".swiper-slide-p").eq(0-i).addClass("slide-p-next").removeClass("slide-p-active").removeClass("slide-p-pre").show():i<initialSlide&&$(".swiper-slide-p").eq(0-i).addClass("slide-p-pre").removeClass("slide-p-active").removeClass("slide-p-next").hide()}function showNavigation(){"desktop"==checkDevice()&&$(".container_screen").off("mouseenter"),$(".container_nav").eq(0).show("drop",{direction:"left"},300)}function hideNavigation(){$(".container_nav").eq(0).hide("drop",{direction:"left"},300),"desktop"==checkDevice()&&$(".container_screen").on("mouseenter",(function(e){showNavigation()}))}function dateToArrayIndex(date){return dayArray.indexOf(date)+1}function arrayIndexToDate(index){return dayArray[index-1]}function showSpinner(){$("#spinner").show()}function hideSpinner(){$("#spinner").hide()}function checkDevice(){return window.screen.width>1281?"desktop":"mobile"}function checkInstalledApp(){return!(!window.matchMedia("(display-mode: standalone)").matches&&!0!==window.navigator.standalone)}function setCookie(name,value,days){var d=new Date;d.setTime(d.getTime()+24*days*60*60*1e3);var expires="expires="+d.toUTCString();document.cookie=name+"="+value+"; "+expires+";"}function getCookie(name){for(var nameEQ=name+"=",ca=document.cookie.split(";"),i=0;i<ca.length;i++){for(var c=ca[i];" "==c.charAt(0);)c=c.substring(1);if(0==c.indexOf(nameEQ))return c.substring(nameEQ.length,c.length)}return""}function getParameterByName(name){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex,results=new RegExp("[\\?&]"+name+"=([^&#]*)").exec(location.search);return null===results?"":decodeURIComponent(results[1].replace(/\+/g," "))}$(window).on("load",(function(){showSpinner(),"serviceWorker"in navigator&&navigator.serviceWorker.register("service-workerbox.js").then((function(){console.log("Service Worker Registered")})),window.addEventListener("appinstalled",(function(){console.log("Thank you for installing our app!"),"desktop"==checkDevice()&&window.location.reload()})),loadDateImages()}));var entity={month:{status:null,positionXAlign:null,positionXPx:null,positionYAlign:null,positionYPx:null,width:null,height:null,style:null,fontImage:null,text:null,fontDirection:null,font:null,fontSize:null},week:{status:null,positionXAlign:null,positionXPx:null,positionYAlign:null,positionYPx:null,width:null,height:null,style:null,fontImage:null,text:null,fontDirection:null,font:null,fontSize:null},day:{status:null,positionXAlign:null,positionXPx:null,positionYAlign:null,positionYPx:null,width:null,height:null,style:null,fontImage:null,text:null,fontDirection:null,font:null,fontSize:null},year:{status:null,positionXAlign:null,positionXPx:null,positionYAlign:null,positionYPx:null,width:null,height:null,style:null,fontImage:null,text:null,fontDirection:null,font:null,fontSize:null}};async function getAutoTextImageArray(){for(var i=1;i<=12;i++){var dateName,blobUrl=(dateName="m"+i)+CALENDAR_CONFIG.imageExt;autoTextArrays.month.blobUrls.push(blobUrl),autoTextArrays.month.widths.push(IMAGE_DIMENSIONS.monthWidth),autoTextArrays.month.heights.push(IMAGE_DIMENSIONS.monthHeight)}for(var i=0;i<=7;i++){var dateName,blobUrl=(dateName="w"+i)+CALENDAR_CONFIG.imageExt;autoTextArrays.week.blobUrls.push(blobUrl),autoTextArrays.week.widths.push(IMAGE_DIMENSIONS.weekWidth),autoTextArrays.week.heights.push(IMAGE_DIMENSIONS.weekHeight)}for(var i=1;i<=31;i++){var dateName,blobUrl=(dateName="d"+i)+CALENDAR_CONFIG.imageExt;autoTextArrays.day.blobUrls.push(blobUrl),autoTextArrays.day.widths.push(IMAGE_DIMENSIONS.dayWidth),autoTextArrays.day.heights.push(IMAGE_DIMENSIONS.dayHeight)}for(var i=0;i<=0;i++){var dateName,blobUrl=(dateName="y"+i)+CALENDAR_CONFIG.imageExt;autoTextArrays.year.blobUrls.push(blobUrl),autoTextArrays.year.widths.push(IMAGE_DIMENSIONS.yearWidth),autoTextArrays.year.heights.push(IMAGE_DIMENSIONS.yearHeight)}}function setAutoTextStyle(dateEntity,dateObject,type){var result="";if("1"==dateEntity.status){var positionXAlign="",translateX="";1==dateEntity.positionXAlign||(2==dateEntity.positionXAlign?(positionXAlign="left: 50%;",translateX="-50%"):3==dateEntity.positionXAlign?positionXAlign="right: 0%;":dateEntity.positionXPx&&(positionXAlign="left: "+dateEntity.positionXPx+"%;"));var positionYAlign="",translateY="";1==dateEntity.positionYAlign||(2==dateEntity.positionYAlign?(positionYAlign="top: 50%;",translateY="-50%"):3==dateEntity.positionYAlign?positionYAlign="bottom: 0%;":dateEntity.positionYPx&&(positionYAlign="top: "+dateEntity.positionYPx+"%;"));var translate="";""!=translateX&&""!=translateY?translate="transform: translate("+translateX+", "+translateY+");":""!=translateX&&""==translateY?translate="transform: translate("+translateX+", 0%);":""==translateX&&""!=translateY&&(translate="transform: translate(0%, "+translateY+");");var width="";parseFloat(dateEntity.width)&&(width="width: "+dateEntity.width+"%;");var height="";parseFloat(dateEntity.height)&&(height="height: "+dateEntity.height+"%;");var style="";dateEntity.style&&(style=dateEntity.style+";");var font="",fontSize="",text="",imgTag="";if("2"!=entity.month.fontImage){var textArray,textArray;if(dateEntity.font&&(font="font-family: "+dateEntity.font+";"),dateEntity.fontSize&&(fontSize="font-size: "+dateEntity.fontSize+";"),dateEntity.text){if("m"==type)text=(textArray=dateEntity.text.split(","))[dateObject.getMonth()];else if("w"==type){var textArray;text=(textArray=dateEntity.text.split(","))[dateObject.getDay()]}else if("d"==type){var textArray;text=(textArray=dateEntity.text.split(","))[dateObject.getDate()-1]}else if("y"==type){var textArray;text=(textArray=dateEntity.text.split(","))[0]}}else if("m"==type)text=(textArray=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"])[dateObject.getMonth()];else if("w"==type){var textArray;text=(textArray=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"])[dateObject.getDay()]}else if("d"==type){var textArray;text=(textArray=["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"])[dateObject.getDate()-1]}else"y"==type&&(text=dateObject.getFullYear());"1"==dateEntity.fontDirection&&(text=text.split("").join("<br/>"))}else{var blobUrl="",autoTextImageWidth="",autoTextImageHeight="";"m"==type?(blobUrl=autoTextArrays.month.blobUrls[dateObject.getMonth()],autoTextImageWidth=autoTextArrays.month.widths[dateObject.getMonth()],autoTextImageHeight=autoTextArrays.month.heights[dateObject.getMonth()]):"w"==type?(blobUrl=autoTextArrays.week.blobUrls[dateObject.getDay()],autoTextImageWidth=autoTextArrays.week.widths[dateObject.getDay()],autoTextImageHeight=autoTextArrays.week.heights[dateObject.getDay()]):"d"==type?(blobUrl=autoTextArrays.day.blobUrls[dateObject.getDate()-1],autoTextImageWidth=autoTextArrays.day.widths[dateObject.getDate()-1],autoTextImageHeight=autoTextArrays.day.heights[dateObject.getDate()-1]):"y"==type&&(blobUrl=autoTextArrays.year.blobUrls[0],autoTextImageWidth=autoTextArrays.year.widths[0],autoTextImageHeight=autoTextArrays.year.heights[0]),blobUrl&&(imgTag='<img style="width: 100%; height:100%" src="'+blobUrl+'">',width||(width="width: "+autoTextImageWidth*aspectRatio+"px;"),height||(height="height: "+autoTextImageHeight*aspectRatio+"px;"))}result+='<div style="position: absolute;'+positionXAlign+positionYAlign+translate+width+height+style+font+fontSize+'">'+text+imgTag+"</div>"}return result}function setAutoText(dateStr){var dateObject=new Date(dateStr),autoText="";return entity&&(entity.month&&(autoText+=setAutoTextStyle(entity.month,dateObject,"m")),entity.week&&(autoText+=setAutoTextStyle(entity.week,dateObject,"w")),entity.day&&(autoText+=setAutoTextStyle(entity.day,dateObject,"d")),entity.year&&(autoText+=setAutoTextStyle(entity.year,dateObject,"y"))),autoText}